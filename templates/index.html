<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Display and Text Entry</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
  </head>
  <body>
    <h1>Image Display</h1>
    <div id="image-container">
      <img
        id="displayed-image"
        src=""
        alt="Image will appear here"
        style="max-width: 100%"
      />
    </div>
    <button id="refresh">Refresh</button>
    <h2>Enter Text:</h2>
    <input type="text" id="user-input" placeholder="Enter your text here" />
    <button id="submit-button">Submit</button>

    <script>
      const socket = io();

      socket.on("connect", () => {
        console.log("Connected to the server");
      });

      socket.on("display_image", function (data) {
        const imageElement = document.getElementById("displayed-image");
        imageElement.src = "data:image/png;base64," + data["image"];
      });

      document.getElementById("submit-button").onclick = function () {
        const userInput = document.getElementById("user-input").value;
        socket.emit("send_text", { text: userInput });
      };

      document.getElementById("refresh").onclick = function () {
        socket.emit("refresh");
      };

      socket.on("disconnect", () => {
        console.log("Disconnected from the server");
      });
    </script>
  </body>
</html>
